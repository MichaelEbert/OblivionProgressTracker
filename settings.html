<!DOCTYPE html>
<html><head>
	<meta charset="UTF-8"/>
	<link rel="icon" type="image/png" href="./favicon.ico"/>
	<link rel="stylesheet" type="text/css" href="css/main.css"/>
	<link rel="stylesheet" type="text/css" href="css/guide.css"/>
	<script src="https://valarnin.github.io/oblivion-save-reader/dist/bundle.savefile.js" defer></script>
    <script src="https://valarnin.github.io/oblivion-save-reader/dist/bundle.record.js" defer></script>
	<script src="./settings.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Settings ‚Äî Interactive Oblivion Checklist</title>
</head>
<body>
	<!-- begin topbar-->
<div id="flexTopBar" class="flexTopBar">
	<nav id="topbar" class="topbar">
		<div class="topbarSection icon">
			<a href="https://prclive.run/"><img src="images/prcbanner.png" style="width: 90px;"></a>
			<div class="topbarSublist">
				<a href="https://www.twitch.tv/prclive" class="topbarSection">Twitch</a>
				<a href="https://www.youtube.com/c/prclive" class="topbarSection">YouTube</a>
				<a href="https://discord.gg/eudsps7" class="topbarSection">Discord</a>
				<a href="https://github.com/MichaelEbert/OblivionProgressTracker" class="topbarSection">GitHub</a>
				<a href="https://twitter.com/_prclive" class="topbarSection">Twitter</a>
			</div>
		</div>
		<div class="topbarSection">
			<a href="./speedrun-guide.html">Guide</a>
			<div class="topbarSublist">
				<a href="./speedrun-guide.html">Speedrun Guide</a>
				<a href="./casual.html">Casual Guide</a>
				<a href="./speedrun-archive.html">Archive</a>
			</div>
		</div>

		<a href="./checklist.html" class="topbarSection">Checklist</a>

		<div class="topbarSection">
			<a href="./map.html">Map</a>
			<div class="topbarSublist">
				<a href="./nirnroute.html">Nirnroute</a>
			</div>
		</div>

		<div class="topbarSection">
			<a href="https://prclive.run/wiki/Oblivion:Tools/Resources">Wiki/Tools</a>
			<div class="topbarSublist">
				<a href="https://prclive.run/wiki/Main_Page">Wiki</a>
				<a href="./tools/tools.html">Tools</a>
				<a href="https://prclive.run/wiki/Oblivion:Glitches/Tech">Glitches</a>
				<a href="https://prclive.run/wiki/Oblivion:Tools/Resources">Tools/Resources Directory</a>
			</div>
		</div>

		<a href="./settings.html" class="topbarSection icon" style="font-size: 0.85em;" title="Settings">‚öôÔ∏è</a>

		<div class="topbarSection"><span class="totalProgressPercent">0</span>%</div> 
	</nav>
</div>
<!-- end topbar-->
<article class="mainPanel">
<h1>Settings</h1>

<div class="section">
<div class="sectionTitle">Sharing</div>
<div class="collapsibleContent">
	<p><i>You can share your progress with other people in real time, so anything you check off will appear on their spectator view! This is highly recommended for streamers so their viewers can follow their progress easily.</i></p>
	<div class="sharingUI">
		<p><b>Share: </b><button id="shareProgressButton" onclick="uploadCurrentSave()">Create Share URL*</button><input type="text" id="myShareUrl" size="60" readonly="true"/><button onclick="copytoClipboard()" class="clipboardButton">üìã</button><span id="shareUrlCopy"></span></p>
		<p><b>Spectate: </b><input type="text" id="remoteShareCode"/><button id="clearRemoteButton">Clear</button><span style="font-size: 0.75em;"> ‚Äî Clicking on someone else's Share URL or entering a 6 letter code and pressing enter on this box will place your in Spectator Mode.</span>
	</div>
	<p><i>When you are in Spectator Mode, a Spectating button will appear at the top right. You cannot change the progress on the guide while spectating. Clicking the X to close Spectating Mode will return your personal progress and allow changing checklist values again. If you want to view someone else's progress in one window and still be able to track your own progress at the same time, using an incognito window to spectate allows for this. Perfect for racing against someone!</i></p>
</div>
<p style="font-size: small"><i>* By creating a share URL, you agree that your progress, progress URL, IP address, and time uploaded may be stored on a server.</i></p>
</div>

<div class="section">
<div class="sectionTitle">Preferences</div>
<div class="collapsibleContent">
	<div class="category">
		<div class="categoryTitle">Guide</div>
		<!--When you add a setting here, also add it in userdata.mjs so it will be populated for new users.-->
		<label><input type="checkbox" id="classnameCheck" class="autosetting"/>Show [Quest], [Book], etc. tags for interactive terms. ‚Äî <b>Advanced players should turn this setting off to improve guide readability.</b></label><br/>
		Info Box Sizing/Link Behavior: <label><select name="iframeCheck" id="iframeCheck" class="autoTextSetting">
			<option value="auto" title="Recommended. Shows/hides the Info Box based on the width of the browser window, opening links in the Info Box if it is visible, or in a new tab if it is not.">Auto</option>
			<option value="on" title="The Info Box is always on screen and links always open inside the Info Box.">Always On</option>
			<option value="off" title="Disables the Info Box entirely, opening links in another tab.">Always Off</option>
			<option value="window" title="Disables the Info Box, opening links in another window. This is useful if you want to cast links to a second monitor while keeping the guide on the original one.">Other Window</option>
		</select> ‚Äî <i>Hover over each option in the drop down menu for an explanation of what it does.</i></label><br/>
		<label><input type="number" id="iframeMinWidth" class="autoTextSetting"/> Minimum browser width to show Info Box to the right of the guide. <i>(Only works if above setting is Auto.)</i></label><br/>
		<label><input type="text" id="iframeWidth" class="autoTextSetting"/> Width of the Info Box to the right of the guide.</label><br/>
	</div>
	<div class="category">
		<div class="categoryTitle">Map</div>
		<p><i>These map settings can also be found on the map page by clicking the "Show Settings" button.</i></p>
		<label><input name="aaa" type="checkbox" id="mapShowPrediscovered" class="autosetting">Show prediscovered locations. ‚Äî <i>These are locations that are "discovered" from the start of the game that do not count towards your progress.</i></label><br/>
		<label><input type="checkbox" id="mapShowDistanceCheck" class="autosetting">Show distance between locations. ‚Äî <i>This is mostly useful for estimating fast travel times while routing.</i></label><br/>
		<label><input type="checkbox" id="mapShowFormId" class="autosetting">Show formIDs on map. ‚Äî <i>This is mostly useful for debugging and routing.</i></label><br/>
	</div>
	<div class="category">
		<div class="categoryTitle">Advanced Sharing</div>
		<div class="info">These settings are for advanced users only and can break the sharing feature if used incorrectly. <b>Do not change these settings unless you are absolutely sure what you are doing.</b></div>
		</br>
		<button id="copyDataLocalButton" disabled>Copy Spectator Progress to Local Progress</button> ‚Äî <i>Overwrites your local data with the data of the person you are currently spectating.</i><br/>
		<label><input type="checkbox" id="autoUploadCheck" class="autosetting"/>Auto Update Shared Progress</label> ‚Äî <i>If you have a Share URL, this setting automatically pushes your new changes to spectators. You will generally want to leave this on.</i><br/>
		<label><input type="checkbox" id="spectateAutoRefresh" class="autosetting"/>Auto Refresh Spectating</label> ‚Äî <i>If you are Spectating, this setting automatically updates your screen to show new changes as the player updates their progress. You will generally want to leave this on.</i><br/>
		<label><input type="number" id="spectateAutoRefreshInterval" class="autoTextSetting"/>Auto Refresh Interval (sec)</label> ‚Äî <i>If you are Spectating, this is the number of seconds between updates to your view of the player's progress.</i><br/>
		<button id="copyShareKeyButton">Copy Share Key to Clipboard</button> ‚Äî <i>Your Share Key is an internal key separate from the public 6 letter code you send to others. This key may be requested by devs if trying to debug/recover data related to your Share URL.</i><br/>
		<label>Share Server Path: <input type="text" id="serverUrl" size="60" class="autoTextSetting"/></label><button onclick="restoreServerPath()">Restore Default Path</button> ‚Äî <i>If you want to save your data to another server instead of ours, you can change that here.</i><br/>
	</div>
</div>
</div>

<div class="section">
<div class="sectionTitle">Import/Export Progress</div>
<div class="collapsibleContent">
	<p><i>This import/export feature is <b>not</b> for Oblivion save (.ess) files. It is for this website's progress (.save) files. Currently the primary reason to backup your interactive guide to a .save file is to make sure you don't lose your Save File numbers for Load Warping. If you do not need to recover this information, dragging your most recent .ess file onto the Checklist page is a more convenient way of restoring your progress.</i></p>
	<button id="resetbutton" onclick="userdata.resetProgress(true)">Reset Progress</button><br/>
	<button id="exportProgressButton" onclick="exportProgress()">Export Guide .save File</button><br/>
	<label>Import Guide Progress (.save) from File: <input type="file" id="fileinput"/></label><br/>
</div>
</div>
</article>

<script type="module">
	import exportNamespace from './js/module-shim.mjs'
	import * as userdata from './js/userdata.mjs'
	import * as obliviondata from './js/obliviondata.mjs'
	import * as sharing from './js/sharing.mjs'
	import * as saveReader from './js/saveReader.mjs'
	exportNamespace(userdata);
	exportNamespace(obliviondata);
	exportNamespace(sharing);
	window.userdata = userdata;
	window.obliviondata = obliviondata;
	window.sharing = sharing;
	window.saveReader = saveReader;
	(function(){
		if(loadCookie("debug") == true){
			window.debug = true;
		}
		init();
	}).call(window);
</script>
<script>
	let percentCompleteSoFar = localStorage.getItem("percentageDone");
	//round progress to 2 decimal places
	let progress = Math.round((percentCompleteSoFar * 100)*100)/100;
	Array.of(...document.getElementsByClassName("totalProgressPercent")).forEach(element => {
		element.innerText = progress.toString();
		if(element.parentElement.className == "topbarSection"){
			element.parentElement.style = `background: linear-gradient(to right, green ${progress.toString()}%, red ${progress.toString()}%);`;
		}
	});
</script>
<script src="collapsible.js"></script>
</body>
</html>