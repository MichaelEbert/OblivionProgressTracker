<!DOCTYPE html>
<html><head>
	<meta charset="UTF-8"/>
	<link rel="icon" type="image/png" href="./favicon.ico"/>
	<link rel="stylesheet" type="text/css" href="main.css"/>
	<link rel="stylesheet" type="text/css" href="guide.css"/>
	<script src="obliviondata.js"></script>
	<script src="base64ArrayBuffer.js"></script>
	<script src="sharing.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Map â€” Interactive Oblivion Checklist</title>
</head>
<body>
<div id="topbar" class="topbar">
	<a href="./index.html" class="topbarSection"> Checklist</a>
	
	<div class="topbarSection">
		<a href="./glitches.html">Glitches</a>
		<div class="topbarSublist">
			<a href="./glitches.html#permakey">Perma Key</a>
			<a href="./glitches.html#boostjump">Boost Jump</a>
			<a href="./glitches.html#duping">Dupe/Duping</a>
			<a href="./glitches.html#qsqldeaggro">QSQL De-Aggro</a>
			<a href="./glitches.html#saveclip">Save Clip</a>
			<a href="./glitches.html#voidwarp">Void Warp</a>
			<a href="./glitches.html#yieldglitch">Yield Glitch</a>
			<a href="./glitches.html#eightpotionglitch">8 Potion Glitch</a>
		</div>
	</div>

	<div class="topbarSection">
		<a href="./casual.html">Casual Guide</a>
		<div class="topbarSublist">
			<a href="./casual.html#top">item1</a>
		</div>
	</div>
	
	<div class="topbarSection">
		<a href="./speedrun-3.html">Speedrun Guide (v3)</a>
		<div class="topbarSublist">
            <a href="./speedrun-3.html#guide_Pregame">Pregame</a>
            <a href="./speedrun-3.html#guide_Tutorial">Tutorial</a>
            <a href="./speedrun-3.html#guide_ImperialCityMarketDistrict">Imperial City Market District</a>
            <a href="./speedrun-3.html#guide_MagesGuildPt1">Mages Guild Pt1</a>
            <a href="./speedrun-3.html#guide_GoldFarming">Gold Farming/Arcane University</a>
            <a href="./speedrun-3.html#guide_InvestingCircuit">Investing Circuit</a>
            <a href="./speedrun-3.html#guide_MagesGuildPt2">Mages Guild Pt2</a>
            <a href="./speedrun-3.html#guide_MainQuestPt1">Main Quest Pt1</a>
            <a href="./speedrun-3.html#guide_MapExploration">Map Exploration</a>
            <a href="./speedrun-3.html#guide_TheNirnroute">The Nirnroute</a>
            <a href="./speedrun-3.html#guide_MainQuestPt2">Main Quest Pt2</a>
            <a href="./speedrun-3.html#guide_FightersGuild">Fighters Guild</a>
            <a href="./speedrun-3.html#guide_TheArena">The Arena</a>
            <a href="./speedrun-3.html#guide_SideQuests">Side Quests</a>
            <a href="./speedrun-3.html#guide_DarkBrotherhood">Dark Brotherhood</a>
            <a href="./speedrun-3.html#guide_PowerLeveling">Power Leveling</a>
            <a href="./speedrun-3.html#guide_ThievesGuild">Thieves Guild</a>
            <a href="./speedrun-3.html#guide_DaedricShrines">Daedric Shrines</a>
            <a href="./speedrun-3.html#guide_HeavenStoneGreaterPowers">Heaven Stone Greater Powers</a>
            <a href="./speedrun-3.html#guide_RandomSkillBooks">Random Skill Books</a>
            <a href="./speedrun-3.html#guide_TheGreatSkillGrind">The Great Skill Grind</a>
            <a href="./speedrun-3.html#guide_AnUnexpectedVoyage">An Unexpected Voyage</a>
            <a href="./speedrun-3.html#guide_ImperialDragonArmor">Imperial Dragon Armor</a>
        </div>
	</div>
	<a href="./map.html" class="topbarSection">Map</a>
	<a href="./nirnroute.html" class="topbarSection">Nirnroute</a>
	<a href="./settings.html" class="topbarSection">Settings</a>
    <div class="topbarSection"><span class="totalProgressPercent">0</span>%</div> 
</div>
<div class="mapContainer" id="mapContainer">
	<div class="mapButtonBar">
		<input type="radio" name="icon_selection" id="button_Location" checked title="Shows all Locations that need to be discovered."><label>Locations</label>
		<input type="radio" name="icon_selection" id="button_Nirnroot" title="Shows where all Nirnroot are in the overworld."/><label>Nirnroots</label>
		<span>&nbsp;&nbsp;&nbsp;</span>
		<input type="checkbox" id="button_ToggleTSP" title="The Traveling Salesman Path(TSP) is the fastest way to visit each location/nirnroot">Show Traveling Salesman Path</input>
		<span>&nbsp;&nbsp;&nbsp;</span>
		<button id="helpButton">Help!</button>
		<span>&nbsp;&nbsp;&nbsp;</span>
		<span>Random gates found: 
			<span id="randomGateCount">##</span> 
		</span>

		<input type="checkbox" id="showHideMapSettingsCheck"/><label>Show Settings</label>
	</div>
	<div id="mapSettingsContainer" style="display:none">
		<input type="checkbox" id="mapShowPrediscovered" class="autosetting"><label>Show prediscovered locations</label><br/>
		<input type="checkbox" id="mapShowDistanceCheck" class="autosetting"><label>Show distance between locations</label><br/>
		<input type="checkbox" id="mapShowLocationsOnNirnroot" class="autosetting"><label>Show fast travel locations on nirnroot map</label><br/>
	</div>
	<div id="help" style="display:none">
		<h2>FAQ</h2>
		<h3>How to use?</h3>
		<p>Double click on an icon to toggle its state between discovered/undiscovered.</p>

		<h3>What is TSP?</h3>
		<p>The Traveling Salesman Path (TSP) is a calculated fastest route between each icon,
			 it doesn't have to be done in order and it loops so you can start anywhere, and as long as you only go one direction, you will get everything on the path.</p>

		<h3>Why are icons inaccurate?</h3>
		<p>On this map, the icons are centered on the exact locations that they are in the oblivion world. 
			In other words, if you go to the center of the icon on this map, you'll be at the exact location of the marker.</p>
		<p>On the in-game map, all icons are offset slightly to the right, which is confusing for first-time users.</p>

		<h3>How do random gates work?</h3>
		<p>You need to only discover 40 random oblivion gates. 
			Once you discover 40, the map will automatically check off the remaining random gate locations on the map, but not on the checklist.</p>
	</div>

	<div id="wrapper_Map" class="mapWrapper"></div>
</div>
<script type="module">
	//normally, we can't call module code from non-module code.
	//exportNamespace appends everything to window, so it can be called like normal js code.
	import exportNamespace from './js/module-shim.mjs'
	import * as userdata from './js/userdata.mjs'
	import * as map from './js/map.mjs';
	import * as point from './js/map/point.mjs';
	exportNamespace(map);
	exportNamespace(point);
	exportNamespace(userdata);
	
	if(loadCookie("debug") == true){
		window.debug = true;
	}
	document.getElementById("helpButton").addEventListener('click',function (){
		const button = document.getElementById("helpButton");
		const helpWindow = document.getElementById("help");
		if(button.innerText == "Help!"){
			helpWindow.style.display = "unset";
			button.innerText = "hide help"
		}
		else{
			helpWindow.style.display = "none";
			button.innerText = "Help!"
		}
	});


	(function(){
		document.getElementById("showHideMapSettingsCheck").addEventListener('change', ()=>{
			const mapSettingsContainer = document.getElementById("mapSettingsContainer");
			if(document.getElementById("showHideMapSettingsCheck").checked){
				mapSettingsContainer.style.display = "unset";
			}
			else{
				mapSettingsContainer.style.display = "none";
			}
		});
		if(document.getElementById("showHideMapSettingsCheck").checked){
			mapSettingsContainer.style.display = "unset";
		}
		else{
			mapSettingsContainer.style.display = "none";
		}
		

		loadJsonData().then(()=>{
			loadProgressFromCookie();
			initMap();
			//need to add events to redraw immediately upon change
			//TODO fix. or move all this stuff into another js file.  or something.
			document.getElementById("mapShowPrediscovered").addEventListener('change',()=>{map.draw();});
			document.getElementById("mapShowLocationsOnNirnroot").addEventListener('change',()=>{
				if(document.getElementById("button_Nirnroot").checked){
					map.getOverlay().setActiveLayer(2);
				}
				else{
					map.getOverlay().setActiveLayer(1);
				}
				map.draw();
			});
		});
	}).call(window);

</script>
<script>
	//I divided these like so for easier editing. 
		//So long as it's all stuffed in alert(), it doesn't matter to me how we store it.
	let welcome = "Welcome to the map!\n\n";
	let clickIcon = "Double-click on an icon when it's been discovered.\n\n";
	let tspExplanation = "The Traveling Salesman Path is a calculated fastest route between each icon, it doesn't have to be done in order and it loops so you can start anywhere, and as long as you only go one direction, you will get everything on the path.\n\n";
	
	//this isn't implemented yet, but should be noted so people aren't surprised when it happens during their run.
	let randomGateNote = "You need to only discover 40 random oblivion gates. Once you discover 40, the map will automatically check off the remaining random gate locations on the map, but not on the checklist."
	
	let helpText = welcome + clickIcon + tspExplanation + randomGateNote;
	
</script>
</body>
</html>